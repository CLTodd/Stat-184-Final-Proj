---
title: "Economic Inequality and Hate Crimes"
output: html_notebook
---


Become acquainted with the data
Explore intuition for the research questions before imposing formal structure (e.g., inferential or predictive dels)
Discover features in the data that influence modeling decisions

```{r, message=FALSE}
#Cleaning Environment
rm(list = ls())

#Loading necessary packages
library(openxlsx)
library(DataComputing)
library(tidyverse)
```
3
spread or gather operation (or equivalent):
use of regular expressions: 
use of reduction and/or transformation functions: 
use of user-defined functions: 
use of loops and/or control flow: 
use of machine learning

3
use of mulitple different geoms:  
use of multiple aesthetics:  
use of layered graphics:  
use of leaflet maps:  
use of decision tree or dendogram results:    



mention 538 and https://ucr.fbi.gov/hate-crime/2016/resource-pages/abouthatecrime

Explanations, definitions, and clarifications of variable names and the codes used for the variables were provided by the [read me in FiveThirtyEight's repo glossary page](https://ucr.fbi.gov/hate-crime/2016/resource-pages/abouthatecrime).

```{r, message=FALSE}
#Importing the Data
CrimeMotiveStateRaw <- openxlsx::read.xlsx(xlsxFile = "Table_13_Hate_Crime_Incidents_per_Bias_Motivation_and_Quarter_by_State_and_Agency_2016.xlsx")

InequalityAndCrime538 <- readr::read_csv("https://raw.githubusercontent.com/fivethirtyeight/data/master/hate-crimes/hate_crimes.csv")

PovertyByState <- readr::read_csv("State Poverty Levels 2016.txt")

```


```{r}
# Inspecting Inequality and Crime data from fivethirtyeight
summary(InequalityAndCrime538)
head(InequalityAndCrime538)
# This table is already clean and tidy, although later on some variable names will be changed and some proportions will be converted to percents for convenience.

# Inspecting Poverty Rate by State data
summary(PovertyByState)
head(PovertyByState)
# This table is already tidy, although later on some variable names might be changes for convention's sake.

# Inspecting the CrimeMotivesStateRaw Table
summary(CrimeMotiveStateRaw)
head(CrimeMotiveStateRaw, 12)

# Cleaning the CrimeMotivesStateRaw Table
CrimeMotiveState <- as.data.frame(CrimeMotiveStateRaw[-c(1:5),]) # removing blank header rows
rownames(CrimeMotiveState) <- 1:nrow(CrimeMotiveState) # re-indexing the rows just because it was bothering me

CrimeMotiveState <-
  CrimeMotiveState %>%
  select(-c(X10, X11, X12, X13, X14)) %>% # removing columns I don't need
  rename(state = `Table.13`, # renaming columns
         race = X4,
         religion = X5,
         sexualOrientation = X6,
         disability = X7,
         gender = X8,
         genderIdentity = X9) %>%
  mutate(Flag = ifelse(is.na(state), "drop", "keep")) %>%# assigning a yes or no value to rows that give the state totals that I'm interested in
  filter(Flag == "keep") %>%
  mutate(race = as.numeric(race),
         religion = as.numeric(religion),
         sexualOrientation = as.numeric(sexualOrientation),
         disability = as.numeric(disability),
         gender = as.numeric(gender),
         genderIdentity = as.numeric(genderIdentity),
         totalHateCrimes = (race + religion + sexualOrientation + disability + gender + genderIdentity)) %>%
  select(-c(Flag))
 
CrimeMotiveState <- CrimeMotiveState[-c(51:53),-c(2,3)] # removing unneccessary footer rows and empty columns
rownames(CrimeMotiveState) <- 1:nrow(CrimeMotiveState) # ensuring rows are re-indexed appropriately
head(CrimeMotiveState, 6) #checking results
```
```{r}
# Joining all data
# First, joining the smaller data sets to make sure everything goes smoothly

PovertyByState <-
  rename(PovertyByState, state = State)

CrimeMotivePoverty <-
  dplyr::full_join(PovertyByState, CrimeMotiveState, by = "state")

#Inspecting Join
head(CrimeMotivePoverty)
nrow(CrimeMotivePoverty)

Master <-
  full_join(CrimeMotivePoverty, InequalityAndCrime538, by = "state")
head(Master)
nrow(Master)
names(Master)
  
```
